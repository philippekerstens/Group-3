<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Covid 19 Dashboard</title>

    <!-- Bootstrap CDN -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
    crossorigin=""/>
    <!-- d3 JavaScript -->
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <!-- Our CSS -->
    <link rel="stylesheet" type="text/css" href="../static/css/style.css">
</head>
<body>
    <div class="wrapper">
        <!-- Build the nav-bar -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <a class="navbar-brand" href="/">Home</a>
            <a class="navbar-nav" href="/form">Fips Form</a>
            <!-- <a class="nav-item nav-link" href="/maps">Interactive Maps</a> -->
            <!-- <a class="nav-item nav-link" href="/charts">Interactive Charts</a> -->
        </nav>
        <!-- The jumbotron div -->
        <div class='jumbotron'>
            <!-- <h1>Covid-19 Dashboard</h1> -->
        </div>
        <!-- The goals and purpose div -->
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-3">
                    <h1>Covid-19 and the burden it places on Hospitals</h1>
                </div>
                <div class="col-md-9">
                    <p>
                      Our group topic is Hospital Bed Availability, something that we chose because of its importance in the face of the Covid-19 Pandemic, especially in regards to the difficulty of the early weeks of the pandemic where medical supplies were lacking, and there were difficulties in finding beds in hospitals to deal with the surge in patients. It is this projects intention to compile a database that can be utilized by healthcare and county officials to recognize when their healthcare systems begin to become overloaded.<br><br>
                      This project focus was chosen as we wished to choose something relevant to our current times and events. We feel strongly that the proper allocation of resources is paramount to getting us all through this pandemic.
                    </p>
                </div>
                <!-- <div class='col-md-2'>  Build the table
                    <div class="dropdown">
                        <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
                          Top 10 by county:
                        </button>
                        <div class="dropdown-menu">
                          <a class="dropdown-item" href="#">Cases</a>
                          <a class="dropdown-item" href="#">Deaths</a>
                          
                        </div>
                    </div>
                    <table class="table table-striped">
                        <thead>
                          <tr>
                            <th>County</th>
                            <th>Cases</th>
                          </tr>
                        </thead>
                        <tbody></tbody>
                      </table>
                </div> -->
                
            </div>
            <div class='row'>
              <div class='col-md-6'>
                <p>
                  <h3>Data Exploration</h3><br><br>
                  Data Retrtieval<br><br>
                  Data was exported from The New York Times (referred to as the 'counties' dataset), CDC ('vaccinations' dataset), and healthdata.gov ('hospitals' dataset). The three datasets were then loaded into S3 buckets as they are too large to upload to github.<br><br>
                  Intial Exploration and Database Creation<br><br>
                  The initial data cleaning notebook, Deliverable_1_input_data, then uses pandas to read three datasets into individual dataframes. Unnecessary columns are then dropped from all three dataframes, including columns with categorical and some float data types, age range columns, and hospital coverage columns. The 'hospitals' dataset only contains weekly aggregations of its data, while the other two datasets contain daily reporting. The 'counties' and 'vaccinations' datasets are aggregated to report weekly totals on the same collection dates as 'hospitals'. To provide a common primary key among the three dataframes, the fips and date columns are turned into and string datatype and concatenated to fomr the fips_date coulmn. A list of unique fips_date values was generated and then removed from all three dataframes, to return equal length dataframes that can easily be merge in PostgreSQL. The remaining float data types are then converted to integers in all three dataframes. Column names are abbreviated to prevent truncating them in SQL. A connection string is then created using create_engine from sqlalchemy to create the schema and load the data into tables in PostgreSQL. After being loaded, the schema needs to be adjusted to create primary keys (fips_date) for the three tables.<br><br>
                  Secondary Data Cleaning<br><br>
                  The data is then read back into the next notebook, Postgres to ML Model Connection, using a SQL join for 'counties' and 'hospitals' creating merged_df and using 'vaccinations' to create vaccinations_df. The two dataframes are then merged and redundant columns are dropped to create ml_ready_df, which contains data from all three tables. Percentage and totals columns are then created adding and/or dividing columns by one another. Infinite values are then changed to NaN and all null rows are dropped.<br><br>
                  The images below were from our initial analysis of what the data looked like and include barcharts of case data vs time and hospital capacity vs time.
                </p>
                <img src="../static/images/Cases.png" alt='case_image' style="width:750px;height:400px;">
                <img src="../static/images/hospital_capacity.png" alt='hospital' style="width:750px;height:400px;">
              </div>
              <div class='col-md-6'>
                <p>
                  <h3>Machine Learning Analysis</h3><br><br>

Preliminary feature of engineering:<br><br>
Linear regression 1 model is designed to predict number of beds needs for COVID patient for facilities. Since our data is collected in weekly base, users can input past weeks data (number of patients who are or might have COVID-19) into the model to predict the number of beds that will be used for upcoming week. Linear regression model 2 model is designed to predict the number of deaths through the number of cases. The number of cases and deaths per week are selected for linear regression model and it will estimate the relationship between independent variable(cases) and one dependent variable(deaths). Additionally, for linear regression model 2, another variable (adult patients who are in ICU bed for COVID) is added to give further estimation of correlation of death and thr rest two variables.<br><br>

How data was split into training and testing sets:<br><br>
For both linear regression model, dependent variable X is reshaped to specify the number of rows and columns. They are fitted (trained) to see the patterns in the data and generate prediction of independent variable(bed needed and deaths). The additional variable (adult patients who are in ICU bed for COVID) and cases for linear regression model 2 is splited into training and testing 0.8 : 0.2. We want to keep 20% of the data subset of the entire dataset for the testing purposes and training the rest 80% for prediction. X train and y train subsets are trained and output is predicted by following tested dependent variables. The accuracy performance of the model 2 was 0.903 which we can be concluded it's prediction is accurate up to 90% of the time.<br><br>

Model choice:<br><br>
The dataset we have is manipulated for continous variables. Supervised machine learning models fits to the dataset we have and also incline to have somewhat pair variables. Thus it was difficult to presume which variables can have possible relationship each other outside of their pairs. Linear regression model can be most effective tool to analyze these paird associated variables. The limitation of our model it's linearity. Due to multiple possible causes that are not counted in our dataset, it's linearity could be temporary (vaccination status, weather and location) or irrelevant because strong correlation does not mean it is cause and effect relationship. The benefit of linear regression is that we can build and see the relationship between the variables intuitively that could have cause and effect relationship. It is easier to interpret compare to other side of machine learning methods, which can provide meaningful relationships with what dataset we have.<br><br>
The images below were grabbed during analysis of the model.
                </p>
                <img src="../static/images/bokeh_plot.png" alt='bokeh_image' style="width:750px;height:400px;">
                <img src="../static/images/newplot.png" alt='newplot' style="width:750px;height:400px;">
              </div>
            </div>
        </div>
    </div>  
    
</body>
</html>